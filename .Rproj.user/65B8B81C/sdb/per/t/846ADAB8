{
    "collab_server" : "",
    "contents" : "UnivariateGUI <- function(X, Tab= 4, Toolkit = \"RGtk2\", ...) {\n\n  options(guiToolkit = Toolkit)\n\n  DoExplore <- function(...){\n    XX= X2[,svalue(CS, index=TRUE)]\n\n    if (length(svalue(CS1, index=TRUE))==1)\n      groups=X3[,svalue(CS1, index=TRUE)]\n    else\n    {groups=as.factor(rep(1, dim(XX)[1]))\n    levels(groups)<- \"Complete Sample\"}\n\n    if (svalue(rb, index=TRUE) ==1) SortByGroups=TRUE\n    else SortByGroups=FALSE\n\n    if (svalue(Descrip)){\n      DESC=BasicDescription(XX,groups, SortByGroups=SortByGroups, Intervals=svalue(Interval))\n      txt=capture.output(DESC)\n      GeneralResults(title=\"Descriptive Exploration\", text=txt)}\n\n    if (svalue(StemandLeaf)){\n      StPlots=StemPlots(XX,groups, SortByGroups=SortByGroups)\n      txt2=capture.output(StPlots)\n      GeneralResults(title=\"Descriptive Exploration\", text=txt2)}\n\n    if (svalue(Boxplot)){\n      if (svalue(rb3, index=TRUE)==1)\n        GroupsTogether=TRUE\n      else\n        GroupsTogether=FALSE\n      BoxPlotPanel(XX, groups=groups, nrows=NULL, panel=svalue(Panel), notch=svalue(Notched), GroupsTogether=GroupsTogether)\n    }\n\n    if (svalue(Errplot)){\n      if (svalue(rb3, index=TRUE)==1)\n        GroupsTogether=TRUE\n      else\n        GroupsTogether=FALSE\n      ErrorBarPlotPanel(XX, groups=groups, nrows=NULL, panel=svalue(Panel), GroupsTogether=GroupsTogether)\n    }\n\n  }\n\n  DoCompare <- function(...){\n    txt=\"    \"\n    require(car)\n\n    XX= X2[,svalue(CS, index=TRUE)]\n\n    if (length(svalue(CS1, index=TRUE))==1)\n      groups=X3[,svalue(CS1, index=TRUE)]\n    else\n    {groups=as.factor(rep(1, dim(XX)[1]))\n    levels(groups)<- \"Complete Sample\"}\n\n    if (svalue(NormTest)){\n    txt=c(txt, capture.output(cat(\"\\n###### NORMALITY TESTS  #######\\n\\n\")))\n    txt2=capture.output(NormalityTests(XX, groups))\n    txt=c(txt, txt2)}\n\n    if (svalue(BartTest) | svalue(LevTest)){\n    txt=c(txt, capture.output(cat(\"\\n###### EQUALITY OF VARIANCES  #######\\n\")))\n    if (svalue(LevTest)){\n    txt=c(txt, capture.output(cat(\"\\nLevene's Test\\n\")))\n    txt2=capture.output(Levene.Tests(XX, groups))\n    txt=c(txt, txt2)}\n\n    if (svalue(BartTest))\n    txt=c(txt, capture.output(cat(\"\\nBartlett's Test\\n\")))\n    txt2=capture.output(Bartlett.Tests(XX, groups))\n    txt=c(txt, txt2)\n    GeneralResults(title=\"Compare Central Tendencies\", text=txt)}\n\n  }\n\n  HandleFactors <- function(...){\n    Selected = svalue(CS1, index=TRUE)\n    if (length(Selected)>1){\n      svalue(CS1, index=TRUE)=Selected[1]\n      gmessage(\"Only one factor can be selected at a time\")\n    }\n  }\n\n  if (Tab==4)\n    TitWin=\"Descriptive Exploration\"\n  else\n    TitWin=\"Means Comparison\"\n\n  window <- gwindow(TitWin)\n  notebook <- gnotebook(container = window)\n  size(notebook) <- c(600, 600)\n\n  # ----------------- Data -------------------------------------\n  DataFrame <- ggroup(container = notebook, label = gettext(\"Numeric Data\"), horizontal = FALSE)\n  Classes=sapply(X,class)\n  Numeric=which(Classes==\"numeric\")\n  X2=X[,Numeric]\n  Table <- gdf(X2, container = DataFrame, expand = TRUE)\n\n  # ----------------- External Data -------------------------------------\n  NoNumeric=which(Classes!=\"numeric\")\n  if (length(NoNumeric)>0){\n    SupDataFrame <- ggroup(container = notebook, label = gettext(\"Categorical Data\"), horizontal = FALSE)\n    X3=as.data.frame(X[,NoNumeric])\n    colnames(X3) <-colnames(X)[NoNumeric]\n    Table <- gdf(X3, container = SupDataFrame, expand = TRUE)\n  }\n\n  # ----------------- Variables selected for the analysis -------------------------------------\n  ActiveFrame <- ggroup(container = notebook, label = gettext(\"Variables\"), horizontal = TRUE)\n  TS = glayout(container = ActiveFrame)\n  TS[1, 1] <- \"Numeric Variables\"\n  TS[2, 1] <- (CS <- gcheckboxgroup(colnames(X2), container = TS, use.table = TRUE))\n  size(CS) <- c(220, 400)\n  svalue(CS) = rep(TRUE, dim(X2)[2])\n\n  if (length(NoNumeric)>0){\n    TS[1, 2] <- \"Categorical Variables\"\n    TS[2, 2] <- (CS1 <- gcheckboxgroup(colnames(X3), container = TS, use.table = TRUE, handler=HandleFactors))\n    size(CS1) <- c(220, 180)\n    Sel=rep(FALSE, dim(X3)[2])\n    Sel[1]=TRUE\n    svalue(CS1) = Sel\n  }\n\n  # ----------------- Descriptive Exploration -------------------------------------\n  AnalysisDef <- ggroup(container = notebook, label = gettext(\"Explore\"), horizontal = FALSE)\n  StatFrame = gframe(text = \"Statistics\", markup = FALSE, horizontal = FALSE, container = AnalysisDef)\n  gp1 <- ggroup(container=StatFrame)\n  Descrip <- gcheckbox(\"Descriptives   \", container = gp1)\n  svalue(Descrip) <- TRUE\n  Interval <- gcheckbox(\"Confidence intervals\", container = gp1)\n  svalue(Interval) <- TRUE\n  sorts <- c(\"Sort by Groups\", \"Sort by Variables\")\n  gp <- ggroup(container=StatFrame)\n  glabel(\"Organize output:\",container=gp, anchor=c(0,1))\n  rb <- gradio(sorts, container=gp)\n  svalue(rb, index = TRUE) <- 2\n\n  PlotFrame = gframe(text = \"Plots\", markup = FALSE, horizontal = FALSE, container = AnalysisDef)\n  DescPlotFrame = gframe(text = \"Descriptive\", markup = FALSE, horizontal = TRUE, container = PlotFrame)\n  StemandLeaf <- gcheckbox(\"Stem-and-leaf\", container = DescPlotFrame)\n  svalue(StemandLeaf) <- FALSE\n  Histog <- gcheckbox(\"Histogram\", container = DescPlotFrame)\n  svalue(Histog) <- FALSE\n\n  BoxPlotFrame = gframe(text = \"Box Plot\", markup = FALSE, horizontal = FALSE, container = PlotFrame)\n  Boxplot <- gcheckbox(\"Draw Box PLot\", container = BoxPlotFrame)\n  svalue(Boxplot) <- TRUE\n  Notched <- gcheckbox(\" Use Notched Box-Plots\", container = BoxPlotFrame)\n  svalue(Notched) <- FALSE\n\n  ErrorPlotFrame = gframe(text = \"Error Bar (Confidence Interval)\", markup = FALSE, horizontal = FALSE, container = PlotFrame)\n  Errplot <- gcheckbox(\"Draw Error Bar Plot\", container = ErrorPlotFrame)\n  svalue(Boxplot) <- TRUE\n\n  OrganizeFrame = gframe(text = \"Organize Oupput\", markup = FALSE, horizontal = FALSE, container = PlotFrame)\n  vars <- c(\"Groups Togeteher\", \"Variables Togeteher\")\n\n  rb3 <- gradio(vars, container=OrganizeFrame)\n  Panel <- gcheckbox(\"Panel (or Separate Plots)\", container = OrganizeFrame)\n  svalue(Panel) <- TRUE\n\n  RunButt <- gbutton(\"Run\", container = AnalysisDef, handler = DoExplore)\n  font(RunButt) <- list(family=\"times\",size=18, weight=\"bold\",style=\"italic\", color=\"red\")\n  size(RunButt) <- c(100, 50)\n\n  # ----------------- Means Comparison -------------------------------------\n  CompareDef <- ggroup(container = notebook, label = gettext(\"Compare\"), horizontal = FALSE)\n  NormalityFrame = gframe(text = \"Normality Tests\", markup = FALSE, horizontal = FALSE, container = CompareDef)\n  NormTest <- gcheckbox(\"Shapiro-Wilk\", container = NormalityFrame)\n  NormPlot <- gcheckbox(\"Normality plots\", container = NormalityFrame)\n  svalue(NormTest) <- TRUE\n\n  VarianceFrame = gframe(text = \"Variance Equality Tests\", markup = FALSE, horizontal = FALSE, container = CompareDef)\n  BartTest <- gcheckbox(\"Bartlett\", container = VarianceFrame)\n  svalue(BartTest) <- TRUE\n  LevTest <- gcheckbox(\"Levene\", container = VarianceFrame)\n  svalue(LevTest) <- TRUE\n\n  MeansFrame = gframe(text = \"Compare Means (Medians)\", markup = FALSE, horizontal = FALSE, container = CompareDef)\n  ParamTest <- gcheckbox(\"Parametric ( t test or ANOVA)\", container = MeansFrame)\n  svalue(ParamTest) <- TRUE\n  NonParamTest <- gcheckbox(\"Non Parametric (Mann-Whitney or Kruskal-Wallis)\", container = MeansFrame)\n  svalue(NonParamTest) <- FALSE\n\n  RunButtC <- gbutton(\"Run\", container = CompareDef, handler = DoCompare)\n  font(RunButtC) <- list(family=\"times\",size=18, weight=\"bold\",style=\"italic\", color=\"green\")\n  size(RunButtC) <- c(100, 50)\n\n  svalue(notebook) <- Tab\n}\n",
    "created" : 1478876986011.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1441920232",
    "id" : "846ADAB8",
    "lastKnownWriteTime" : 1479718687,
    "last_content_update" : 1479718687787,
    "path" : "~/Dropbox/0 ProgramasR/Paquetes/MultBiplotRGUI/R/UnivariateGUI.R",
    "project_path" : "R/UnivariateGUI.R",
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : true,
    "source_window" : "",
    "type" : "r_source"
}